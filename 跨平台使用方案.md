# 跨平台使用方案（Mac + Windows）

## 方案一：云数据库方案 ⭐ 推荐

### 优点
- ✅ 数据实时同步，无需手动操作
- ✅ 多设备同时访问，数据一致
- ✅ 配置简单，只需修改 `.env` 文件
- ✅ 数据安全，有备份机制

### 实现步骤

#### 1. 选择云数据库服务
- **阿里云 RDS MySQL**：https://www.aliyun.com/product/rds/mysql
- **腾讯云 MySQL**：https://cloud.tencent.com/product/cdb
- **AWS RDS**：https://aws.amazon.com/cn/rds/mysql/
- **PlanetScale**（免费额度）：https://planetscale.com/

#### 2. 创建云数据库实例
- 创建 MySQL 实例
- 记录：主机地址、端口、用户名、密码、数据库名

#### 3. 在 Mac 和 Windows 上配置

**Mac 端：**
```bash
# 创建 .env 文件
cp .env.example .env

# 编辑 .env，填入云数据库信息
DB_HOST=your-cloud-db-host.mysql.rds.aliyuncs.com
DB_USER=your_username
DB_PASSWORD=your_password
DB_NAME=dish_accounting
DB_PORT=3306
```

**Windows 端：**
- 同样创建 `.env` 文件，使用相同的云数据库配置

#### 4. 初始化数据库
在任意一台设备上运行：
```bash
npm run init-db
```

#### 5. 启动应用
```bash
npm run dev
```

### 注意事项
- 确保云数据库允许外网访问（配置白名单）
- 建议使用强密码
- 定期备份数据库

---

## 方案二：SQLite + 云存储同步

### 优点
- ✅ 无需云数据库费用
- ✅ 使用 Dropbox/iCloud/OneDrive 同步
- ✅ 本地数据库，速度快

### 缺点
- ⚠️ 需要手动同步，可能冲突
- ⚠️ 需要修改代码支持 SQLite

### 实现步骤

#### 1. 安装 SQLite
```bash
npm install better-sqlite3
```

#### 2. 修改数据库配置
将 `server/config/database.js` 改为使用 SQLite

#### 3. 将数据库文件放在云同步文件夹
- Mac: `~/Library/Mobile Documents/com~apple~CloudDocs/记账系统/`
- Windows: `C:\Users\YourName\OneDrive\记账系统\`

---

## 方案三：完全云端部署

### 优点
- ✅ 随时随地访问（浏览器即可）
- ✅ 无需本地安装环境
- ✅ 数据集中管理

### 实现步骤

#### 1. 部署选项
- **Vercel**（前端）+ **Railway**（后端+数据库）
- **阿里云/腾讯云** 服务器
- **Docker** 容器化部署

#### 2. 需要修改
- 前端 API 地址改为服务器地址
- 配置 CORS 允许跨域
- 使用 HTTPS

---

## 方案四：本地 MySQL + Git 同步（不推荐）

### 缺点
- ❌ 数据库文件冲突风险
- ❌ 需要手动处理合并
- ❌ 不适合频繁使用

---

## 推荐配置示例

### .env 文件（云数据库）
```env
# 云数据库配置（Mac 和 Windows 使用相同配置）
DB_HOST=your-cloud-db-host.mysql.rds.aliyuncs.com
DB_USER=your_username
DB_PASSWORD=your_strong_password
DB_NAME=dish_accounting
DB_PORT=3306

PORT=5000
```

### 快速切换脚本

可以创建两个配置文件：
- `.env.local` - 本地数据库
- `.env.cloud` - 云数据库

切换时：
```bash
# Mac/Windows 通用
cp .env.cloud .env  # 使用云数据库
cp .env.local .env  # 使用本地数据库
```

---

## 安全建议

1. **不要将 `.env` 文件提交到 Git**
   - 确保 `.gitignore` 包含 `.env`

2. **使用环境变量**
   - 生产环境使用环境变量而非文件

3. **数据库白名单**
   - 云数据库只允许特定 IP 访问

4. **定期备份**
   - 设置自动备份策略

---

## 推荐方案对比

| 方案 | 难度 | 成本 | 同步性 | 推荐度 |
|------|------|------|--------|--------|
| 云数据库 | ⭐ 简单 | 💰 低 | ⭐⭐⭐ 实时 | ⭐⭐⭐⭐⭐ |
| SQLite+云存储 | ⭐⭐ 中等 | 💰 免费 | ⭐⭐ 手动 | ⭐⭐⭐ |
| 云端部署 | ⭐⭐⭐ 复杂 | 💰 中 | ⭐⭐⭐ 实时 | ⭐⭐⭐⭐ |

**建议：优先使用方案一（云数据库）**

