# 测试打包后的应用

## ✅ 文件已正确打包

通过检查 `app.asar` 文件，确认以下文件已正确打包：
- ✅ `client/build/index.html`
- ✅ `client/build/static/` 目录
- ✅ 所有静态资源文件

## 🚀 测试步骤

### 方法 1：直接运行应用

```bash
cd dist/mac-arm64
./记账系统.app/Contents/MacOS/记账系统
```

查看控制台输出，应该能看到：
- ✅ Electron 应用已就绪
- ✅ 找到文件，加载: [路径]
- ✅ 文件加载成功

### 方法 2：从 DMG 安装后运行

1. 打开 `dist/记账系统-1.0.0-arm64.dmg`
2. 将应用拖拽到 Applications 文件夹
3. 从 Applications 启动应用

### 方法 3：查看详细日志

```bash
cd dist/mac-arm64
./记账系统.app/Contents/MacOS/记账系统 2>&1 | tee app.log
```

然后查看 `app.log` 文件中的详细输出。

## 🔍 如果仍然空白

### 检查 1：启用开发者工具

在 `electron/main.js` 的 `createWindow()` 函数中，临时添加：

```javascript
if (!isDev) {
  mainWindow.webContents.openDevTools();
}
```

重新打包后运行，查看浏览器控制台的错误信息。

### 检查 2：验证 asar 文件内容

```bash
npx asar list dist/mac-arm64/记账系统.app/Contents/Resources/app.asar | grep "client/build"
```

应该能看到所有文件。

### 检查 3：检查路径解析

在控制台日志中查找：
- `📂 应用路径:` - 应该显示正确的路径
- `📄 尝试路径:` - 应该显示多个尝试的路径
- `📄 文件存在:` - 应该显示 `true`

## 📝 注意事项

1. **asar 文件**：Electron 默认将应用打包成 asar 格式，`loadFile` 应该能自动处理
2. **路径解析**：`app.getAppPath()` 在打包后会返回 asar 文件的路径
3. **静态资源**：由于使用了 `homepage: "."`，静态资源使用相对路径，应该能正常加载

## 🐛 常见问题

### 问题：路径显示存在但页面空白

**可能原因**：静态资源路径问题

**解决**：检查浏览器控制台的 Network 标签，查看哪些资源加载失败

### 问题：控制台显示 "找不到文件"

**可能原因**：路径拼接错误

**解决**：查看日志中的实际路径，确认 `app.getAppPath()` 的返回值

