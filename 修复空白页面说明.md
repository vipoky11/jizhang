# 修复空白页面问题

## 🔍 问题分析

打包后的 Electron 应用窗口显示但内容空白，通常是因为：

1. **静态资源路径问题**：React 打包后的 JS/CSS 文件路径不正确
2. **文件路径问题**：`index.html` 文件路径不正确
3. **服务器未启动**：后端服务器可能未正常启动

## ✅ 已修复的问题

### 1. 添加 `homepage: "."` 到 `client/package.json`

这会让 React 使用相对路径而不是绝对路径，在 Electron 的 `file://` 协议下能正确加载静态资源。

### 2. 增强错误日志

添加了详细的日志输出，包括：
- 文件路径检查
- 静态资源目录检查
- 加载状态监控

## 🚀 解决步骤

### 步骤 1：重新构建前端

```bash
cd client
npm run build
cd ..
```

### 步骤 2：重新打包

```bash
npm run electron:build
```

### 步骤 3：运行并查看日志

```bash
cd dist/mac
./记账系统.app/Contents/MacOS/记账系统
```

查看控制台输出，应该能看到：
- ✅ 找到文件，加载: [路径]
- ✅ 静态资源目录存在: [路径]
- ✅ 文件加载成功

## 🐛 如果仍然空白

### 检查 1：确认文件存在

```bash
ls -la dist/mac/记账系统.app/Contents/Resources/app/client/build/
```

应该看到：
- `index.html`
- `static/` 目录（包含 JS 和 CSS 文件）

### 检查 2：查看浏览器控制台

在 `electron/main.js` 中临时取消注释：

```javascript
mainWindow.webContents.openDevTools();
```

然后重新打包运行，查看浏览器控制台的错误信息。

### 检查 3：手动测试 HTML 文件

```bash
open dist/mac/记账系统.app/Contents/Resources/app/client/build/index.html
```

如果浏览器中能正常显示，说明问题在 Electron 的加载方式。

## 📝 常见错误

### 错误 1：`Failed to load resource: net::ERR_FILE_NOT_FOUND`

**原因**：静态资源路径不正确

**解决**：确保 `client/package.json` 中有 `"homepage": "."`

### 错误 2：`Cannot GET /`

**原因**：后端服务器未启动

**解决**：查看控制台日志，确认服务器是否正常启动

### 错误 3：页面显示但 API 请求失败

**原因**：前端 API 配置指向了错误的地址

**解决**：检查 `client/src/api/*.js` 中的 `API_BASE_URL` 配置

## 🔧 调试技巧

### 1. 启用开发者工具

在 `createWindow()` 函数中：

```javascript
if (!isDev) {
  mainWindow.webContents.openDevTools();
}
```

### 2. 检查网络请求

在开发者工具的 Network 标签中，查看哪些资源加载失败。

### 3. 检查控制台错误

查看 Console 标签中的 JavaScript 错误。

## 📞 如果问题仍然存在

请提供：
1. 控制台的完整输出
2. 浏览器开发者工具中的错误信息
3. `dist/mac/记账系统.app/Contents/Resources/app/client/build/` 目录的文件列表

